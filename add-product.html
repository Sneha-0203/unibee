<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Products - Admin Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; box-sizing: border-box; }
        .sidebar { width: 220px; position: fixed; height: 100%; background: #2c3e50; color: #fff; padding: 20px; overflow-y: auto; }
        .sidebar a { color: #fff; text-decoration: none; display: block; padding: 12px; transition: background 0.3s; }
        .sidebar a:hover { background: #34495e; }
        .main-content { margin-left: 240px; padding: 20px; }
        
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
        th { background-color: #16a085; color: white; }
        .calculate-btn, button[type="submit"], button[type="button"] {
            padding: 8px 12px;
            background-color: #27ae60;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .calculate-btn:hover, button[type="submit"]:hover, button[type="button"]:hover { background-color: #2ecc71; }

        @media (max-width: 1024px) {
            .sidebar { width: 180px; }
            .main-content { margin-left: 200px; }
        }
        
        @media (max-width: 768px) {
            .sidebar { width: 100%; height: auto; position: relative; text-align: center; }
            .main-content { margin-left: 0; padding: 10px; }
            th, td { font-size: 12px; padding: 5px; }
            .calculate-btn, button { font-size: 12px; padding: 5px 8px; }
        }

        @media (max-width: 480px) {
            th, td { font-size: 10px; padding: 3px; }
            .sidebar a { padding: 8px; font-size: 12px; }
            .calculate-btn, button { font-size: 10px; padding: 4px 6px; }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>Uni Bee</h2>
        <a href="admin-dashboard.html">Dashboard</a>
        <a href="add-products.html">Add Products</a>
        <a href="product-history.html">Product History</a>
        <a href="sales-report.html">Sales Report</a>
        <a href="logout.html">Logout</a>
    </div>
    <div class="main-content">
        <h1>Add Products</h1>
        <h1>Add Products</h1>
        <form action="save-product.php" method="POST" enctype="multipart/form-data" onsubmit="return validateForm()">
            <table>
                <thead>
                    <tr>
                        <th>Product ID</th>
                        <th>Product Name</th>
                        <th>Category</th>
                        <th>Description</th>
                        <th>Price ($)</th>
                        <th>Offer (%)</th>
                        <th>Offer Price ($)</th>
                        <th>Action</th>
                        <th>Image</th>
                        <th>Stock</th>
                        <th>Supplier Name</th>
                        <th>Supplier Contact</th>
                        <th>Supplier Email</th>
                        <th>Supplier Address</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="product-container">
                    <tr class="product-entry">
                        <td><input type="text" name="product_id[]" required></td>
                        <td><input type="text" name="product_name[]" required></td>
                        <td>
                            <select name="category[]" required>
                                <option value="Sports">Sports</option>
                                <option value="Casual">Casual</option>
                                <option value="Formal">Formal</option>
                                <option value="Modify">Modify</option>
                            </select>
                        </td>
                        <td><textarea name="product_description[]" required></textarea></td>
                        <td><input type="number" name="product_price[]" required step="0.01"></td>
                        <td><input type="number" name="offer[]" required step="1" min="0" max="100"></td>
                        <td>
                            <input type="text" name="offer_price[]" readonly>
                            <button type="button" class="calculate-btn" onclick="calculateOfferPrice(this)">Calculate</button>
                        </td>
                        <td><input type="file" name="product_image[]" required></td>
                        <td><input type="number" name="available_stock[]" required></td>
                        <td><input type="text" name="supplier_name[]" required></td>
                        <td><input type="text" name="supplier_contact[]" required></td>
                        <td><input type="email" name="supplier_email[]" required></td>
                        <td><input type="text" name="supplier_address[]" required></td>
                        <td><button type="button" onclick="removeProduct(this)">Remove</button></td>
                    </tr>
                </tbody>
            </table>
            <button type="button" onclick="addProduct()">Add Another Product</button>
            <button type="submit">Submit Products</button>
        </form>
    </div>

    <script>
        // ✅ 1. JavaScript Form Validation (Price, Offer, Email, Contact)
function validatePrice(input) {
    if (input.value < 0) {
        alert('Price cannot be negative!');
        input.value = '';
    }
}

function checkStock(input) {
    if (input.value < 1) {
        alert('Stock must be at least 1');
        input.value = '';
    }
}

function validateForm() {
    const emails = document.querySelectorAll('input[name="supplier_email[]"]');
    const contacts = document.querySelectorAll('input[name="supplier_contact[]"]');
    for (let i = 0; i < emails.length; i++) {
        if (!emails[i].value.includes('@')) {
            alert('Invalid email format');
            return false;
        }
        if (!/^\d{10}$/.test(contacts[i].value)) {
            alert('Supplier contact must be a 10-digit number');
            return false;
        }
    }
    return true;
}

// ✅ 2. Confirmation Alert Before Submission
function confirmSubmission() {
    return confirm("Are you sure you want to submit these products?");
}

// ✅ 3. Offer Price Calculation
function calculateOfferPrice(input) {
    const row = input.closest('tr');
    const price = parseFloat(row.querySelector('input[name="product_price[]"]').value);
    const offer = parseFloat(input.value);
    if (!isNaN(price) && !isNaN(offer)) {
        const offerPrice = price - (price * (offer / 100));
        row.querySelector('input[name="offer_price[]"]').value = offerPrice.toFixed(2);
    }
}

// ✅ 4. Image Preview Feature
function showPreview(input) {
    const row = input.closest('tr');
    const preview = row.querySelector('.preview');
    const file = input.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.src = e.target.result;
            preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
    } else {
        preview.src = '#';
        preview.style.display = 'none';
    }
}

// ✅ 5. Add Another Product (Pagination Effect)
function addProduct() {
    const container = document.getElementById('product-container');
    const newRow = container.querySelector('.product-entry').cloneNode(true);
    newRow.querySelectorAll('input').forEach(input => input.value = '');
    newRow.querySelectorAll('textarea').forEach(input => input.value = '');
    newRow.querySelector('.preview').src = '#';
    newRow.querySelector('.preview').style.display = 'none';
    container.appendChild(newRow);
}

// ✅ 6. Remove a Product Row
function removeProduct(button) {
    const row = button.closest('tr');
    if (document.querySelectorAll('.product-entry').length > 1) {
        row.remove();
    } else {
        alert('You cannot remove the last product row.');
}
        // Function to validate the form before submission
        function validateForm() {
            const rows = document.querySelectorAll('.product-entry');
            for (const row of rows) {
                const price = row.querySelector('input[name="product_price[]"]').value;
                const offer = row.querySelector('input[name="offer[]"]').value;
                if (!price || !offer) {
                    alert('Please fill all fields before submitting.');
                    return false;
                }
            }
            return true;
        }
    </script>
</body>
</html>
